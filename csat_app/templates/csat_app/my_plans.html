{% extends "base.html" %}

{% block title %}My Saved Plans{% endblock %}

{% block content %}
<h1>My Saved Plans</h1>

<!-- Saved Plans (from DB) -->
{% if saved_plans %}
    <h2>Saved Plans</h2>
    <ul class="list-group mb-4">
    {% for plan in saved_plans %}
        <li class="list-group-item d-flex justify-content-between align-items-center">
            <div>
                <strong>{{ plan.name }}</strong> 
                <small class="text-muted">(created {{ plan.created_at|date:"M d, Y" }})</small>
                <a href="{% url 'load_plan' plan.id %}" class="btn btn-primary btn-sm">Load Plan</a>
                <a href="{% url 'generate_briefing' plan.id %}" class="btn btn-primary btn-sm">Generate Daily Safety Briefing</a>
            </div>            
        </li>
    {% endfor %}
    </ul>
{% else %}
    <p>You haven't saved any plans yet.</p>
{% endif %}

<!-- Current Draft Plan (from session) -->
<h2>Current Draft Plan</h2>
{% if activities %}
    <p>You have {{ activities|length }} activities in your current draft:</p>
    <ul class="list-group mb-4">
    {% for act in activities %}
        <li class="list-group-item">
            {{ act.name }} ({{ act.height }} ft, {{ act.month }}, {{ act.state }}, crew: {{ act.crew }})
        </li>
    {% endfor %}
    </ul>
    <a href="{% url 'risk_assessment' %}" class="btn btn-success">Back to Risk Assessment</a>
{% else %}
    <p>No activities in current draft.</p>
    <a href="{% url 'risk_assessment' %}" class="btn btn-primary">Go to Risk Assessment</a>
{% endif %}

{% endblock %}